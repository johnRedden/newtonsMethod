<!DOCTYPE html>

<html>
        <!-- Bootstrap Link -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">            
        <!--jQuery Link-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
        
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  
        <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
  
        <script src="js/mathjs.js"></script>
  
         <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/0.99.5/jsxgraphcore.js"></script>
  
        <!--CSS Added-->
        <style type="text/css">

body{
  background-image: url("pictures/background.jpg");
}
 
.jumbotron{
    padding-top: 50px;
    padding-right: 20px;
    padding-bottom: 50px;
    padding-left: 20px;
    border: 2px solid #737373;
    width: 80%;
    margin-left: auto;
    margin-right: auto;
    box-shadow: 10px 10px 5px grey;
}

  h1{
  color: white;
    text-shadow: 1px 1px 2px #e6e6e6, 0 0 25px gray, 0 0 5px gray;
}

</style>

<head>
    
    <title>Root Calculator</title>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script> 
    
</head>

<body>
  <h1 align="center">Newton's Method <small>Coming Soon!</small></h1>

<div class="jumbotron" style= "background-color: #e6e6e6;">
  
  <div class = "row">
  <!--Same Inputs but with new styling-->
    <div class="col-xs-2">
        <div class="input-group">
          <span class="input-group-addon" id="basic-addon1">X^2</span>
          <!--inputA-->
          <input type="text" class="form-control" id="inputA" placeholder="#" autofocus>
        </div>
    </div>
         
    <div class="col-xs-2">
        <div class="input-group">
          <span class="input-group-addon" id="basic-addon1">X</span>
          <!--inputB-->
          <input type="text" class="form-control" id="inputB" placeholder="#">
        </div>
    </div>

    <div class="col-xs-2">
        <div class="input-group">
          <span class="input-group-addon" id="basic-addon1">c</span>
          <!--inputC-->
          <input type="text" class="form-control" id="inputC" placeholder="#">
        </div>
    </div>

    <div class="col-xs-2">
        <div class="input-group">
          <span class="input-group-addon" id="basic-addon1">Xn</span>
          <!--inputXn-->
          <input type="text" class="form-control" id="inputXn" placeholder="#">
        </div>
    </div>

    <div class="col-xs-2">
        <div class="input-group">
          <span class="input-group-addon" id="basic-addon1">0.01</span>
          <!--inputPrecision-->
          <input type="text" class="form-control" id="inputPrecision" placeholder="precision">
        </div>
    </div>
   
        <div class="col-xs-2">
          <!--Enter Button-->
          <button type="button" class="btn btn-success" id= "myButton" ><span class="glyphicon glyphicon-ok"></span></button>
          <!--Clear Button-->
          <button type="button" class="btn btn-danger" id= "ClearButton" ><span class="glyphicon glyphicon-remove"></span></button>
          <!--Insert Button-->
          <button type="button" class="btn btn-info" id= "InsertButton" ><span class="glyphicon glyphicon-plus"></span></button>
        </div>
  </div><!--Row End-->
        <br>
        <div class="row">
       <div class="col-xs-6">
       <input type="range" id="MySlider" min="1" max="15" step="1" value="1"></br>
       <p id="MySliderResult" align="center"><kbd>1 Decimal Place(s)</kbd></p>
       </div>
       <div class="col-xs-6">
        <input type="range" id="MySliderPrecision" min="1" max="15" step="1" value="1"></br>
       <p id="MySliderPrecisionResult" align="center"><kbd>0.001 Precision</kbd></p>
       </div>
     </div>
      

     </div><!--Close Jumbotron-->


    <!--Second Jumbotron [contains answers]-->

    <div class="jumbotron" id="AnswersJumbotron" style="visibility: hidden; background-color: #e6e6e6;" align="left">
      <div class="row">
          <div id = "col_Left" class="col-xs-6" style="visibility: hidden;"><p id="myOutput">Answer</p></div>
          <div id = "col_Right" class="col-xs-6" style="visibility: hidden;"><p id="ChangeX">Change of X</p></div>
      </div>
    </div>
    
    
    <div class = "jumbotron">
    <input type="text" class="form-control" id="inputfunction" placeholder="function">
		<p id = "OutputParagraph">Output</p>

	</div>
  
  <div class = "jumbotron">
     <div id="myGraph" class="jxgbox center-block" style='width:400px; height:250px; border: 1px solid lightgray'></div>
	</div>
   
  <script>
       var board;
      $( document ).ready(function() {

            
            //Grapher Stuff
            board = JXG.JSXGraph.initBoard('myGraph',
                     {
                         boundingbox:[-7,2,7,-2],
                         axis: { ticks: { drawLabels: true }, firstArrow: true, strokeColor: 'black' },
                         grid: { strokeWidth: 0.75 },
                         showCopyright: false,
                         showNavigation: false,
                         keepaspectratio: false, //square graph coming in
                         zoom: {
                            factorX: 1.25,  // horizontal zoom factor (multiplied to JXG.Board#zoomX)
                            factorY: 1.25,  // vertical zoom factor (multiplied to JXG.Board#zoomY)
                            wheel: true,   // allow zooming by mouse wheel
                            needshift: false, // mouse wheel zooming needs pressing of the shift key
                             eps: 0.1        // minimal values of JXG.Board#zoomX and JXG.Board#zoomY
                         },
                         pan: {
                            enabled: true,   // Allow panning
                            needTwoFingers: true, // panningis done with two fingers on touch devices
                            needshift: false, // mouse panning needs pressing of the shift key
                         }
                         
                     });
                     
                   

         });
            
            
            
            

          //Fade In Animation Occurs when Check Button is Pressed
          var FadeInOnceOnly = 0;
           $("#myButton").click(function(){
                    //if statement prevents fade in more than once
                      if(FadeInOnceOnly == 0){
                              FadeInOnceOnly++;
                              //Fades in different pieces
                              // $('#JumbotronAnswer').css({ opacity: 0.0, visibility: "visible" }).animate({ opacity: 1.0 }, 1 * 1000);
                              $('#AnswersJumbotron').css({ opacity: 0.0, visibility: "visible" }).animate({ opacity: 1.0 }, 1 * 1000);
                              $('#myOutput').css({ opacity: 0.0, visibility: "visible" }).animate({ opacity: 1.0 }, 1 * 2000);
                              $('#ChangeX').css({ opacity: 0.0, visibility: "visible" }).animate({ opacity: 1.0 }, 1 * 3000);
                    
                              $("#AnswersJumbotron").show(1000);
                                $("#myOutput").show(1500);
                                  $("#ChangeX").show(2000);
                      }
            });

                                                                                    
                                                                                    
                                                                             //   ~INPUT~
        
        // Getting input variables
        var a;
        var b;
        var c;
       // xn is first guess
        var xn;
       // precision is a user input of how precise they want the answer
        var precision; 
        
        
        console.log("Before inputs");
        
                                                                                // ~OUTPUT~
                                                                                
               
        //doing the math
        var func;  // function
        var deriv;  // derivative
        var ans;    // answer
        // delta is used to measure convergence
        var delta;
           
        //Slider #
        var SliderValue = 1
        //Slider Update for HTML and SliderValue variable  --- populates when slider is moved
        $(document).on('input', '#MySlider', function() {
         SliderValue = $(this).val()
        $('#MySliderResult').html( "<kbd>" + $(this).val() + " Decimal Place(s)</kbd>" );
        //console.log(SliderValue);

        });


           
           $("#myButton").click(function(){

                //Populating variables
                a = $("#inputA").val();
                a = parseInt(a);
                b = $("#inputB").val();
                b = parseInt(b);
                c = $("#inputC").val();
                c = parseInt(c);
                xn = $("#inputXn").val();
                xn = parseInt(xn);
                precision = $("#inputPrecision").val();
                precision = parseInt(precision);
             
                  // Check if input is 0 or null          
                if( a == 0 || a == null )
                {
                  console.log("If-then A worked");
                  a = 0;
                }          
                if( b == 0 || b == null )
                {
                  console.log("If-then B worked");
                  b = 0;
                }          
                if( c == 0 || c == null )
                {
                  console.log("If-then C worked");
                  c = 0;
                }
          

                //Set f(x)
                func = a*xn*xn + b*xn + c
                
                //Set f'(x)
                deriv = 2*a*xn + b;
                
                //Set Answer
                ans = xn - func/deriv;
                
                // delta starts as the first guess equal to whatever value to user inputs.
                // during the do loop it is set to = ans - xn, effectively making it the difference between the most recent
                // answer and the last answer.
                delta = xn;
            

                //showing results
                var Result = "";
                var ChangeOfxResult = "";
                
                //counter
                var counter = 0;

              do { //Beginning of Loop for amount of iterations
                
                    //Set f(x)
                    func = a*xn*xn + b*xn + c
                    //Set f'(x)
                    deriv = 2*a*xn + b;
                    //Set Answer
                    ans = xn - func/deriv;
                      
                    //Set Delta
                    delta = ans - xn;
          
                    // xn will be set to the new answer in preparation for another loop
                    xn = ans;
          
                    //Adding counter to track number of loop iterations
                    counter ++ ;
          
                    //Writing to MyOutput String
                    Result += "x" + counter + "= " + (ans).toFixed(SliderValue) + "<br>";
          
                    //Writing to ChangeX string
                    ChangeOfxResult += "<span class = 'glyphicon glyphicon-triangle-top'></span>X" + counter + "= " + (delta).toFixed(SliderValue) + "<br>";
          
                    
                    // case for imaginary numbers
                    if (counter > 10000)
                    {
                      Result = "It looks like this function doesn't converge to a root!"; //+ "<br>" + Result
                      ChangeOfxResult = "";
                      
                      break;
                      
                     }
              
              } while (delta > precision || delta < (precision*-1));
              
           //Outputting results to webpage
           $('#myOutput').html(Result);
           $('#ChangeX').html(ChangeOfxResult);
       });
          
           //Clear Button
        $("#ClearButton").click(function(){
           
            $('#inputA').val('');
            $('#inputB').val('');
            $('#inputC').val('');
            $('#inputXn').val('');
            $('#inputPrecision').val('');

            //Clears Variables
            Result = "";
            ChangeOfxResult = "";
            counter = 0;
             a = 0;
             b = 0;
             c = 0;
            xn = 0;
            precision = 0.01; 
            func = 0;
            deriv = 0;
            ans = 0;
            delta = 0;
            FadeInOnceOnly = 0;
            $("#AnswersJumbotron").hide(2000);
            $("#myOutput").hide(1500);
            $("#ChangeX").hide(1000);

         });//Clear Button end

        //Insert Button
        $("#InsertButton").click(function(){
           
            $('#inputA').val('1');
            $('#inputB').val('-1');
            $('#inputC').val('-6');
            $('#inputXn').val('1');
            $('#inputPrecision').val('0.001');

         });//Insert Button end
           
       var DrawingGraph;
       
       $('#inputfunction').on("keypress", function(e) {

            if (e.keyCode == 13) {
      
                  var input = $('#inputfunction').val();
                  var out = mathjs(input, 'x');
            
                  $("#OutputParagraph").html(out);
                
                     board.removeObject(DrawingGraph);
                     
                  // Create a function graph for f(x) = sin(x)
                   DrawingGraph = board.create('functiongraph',[function(x){ with(Math) return eval(out);}]);
                
            }//end if     
      
      });//Closes on keypress
      
      // go get algebraics library for derivatives
      // send algebraics the user input
      // get back derivative send to math.js
      // calculations
      
    
  </script>
</body>
</html>


